# **图像分割:**

## **一.综述:**

1. 图像分割类型：
    1. 语义分割：像素级别的分类。
    2. 实例分割：目标检测和语义分割的结合，实例分割不但要将目标检测出来(目标检测)，进行像素级别的分类(语义分割)，还需在具体的类别基础上区别开不同的实例。
    3. 全景分割：语义分割和实例分割的结合，即要对所有目标都检测出来又要区分出同个类别中的不同实例。

2. 语义分割性能指标：
    1. mAcc(mean accuracy):predict和ground truth对应位置的分类准确率。
    2. mIoU(mean intersection-over-union):分割每一类别的交并比的均值。
    ![](.\images\2021-01-27-18-19-58.png)

3. 输入图像需与输出图像大小相同。

## **二.上采样:**

1. 单线性插值：
    即通过位置关系来得到像素值的大小。
    ![](.\images\2021-01-27-20-03-26.png)

2. 双线性插值：
    实际为在两个方向上进行单线性插值。
    ![](.\images\2021-01-27-20-54-28.png)
    ![](.\images\2021-01-27-20-54-59.png)

3. 反卷积：需将卷积核(顺逆)旋转180度，再进行有padding的conv操作。

4. Unpooling:
    ![](.\images\2021-01-27-19-03-26.png)

## **三.FCN(Fully Convolutional Networks):**

1. 与图像分类的区别：没有FC(全连接)层。

2. 将FC层换为1×1的卷积层，只改变channel的大小。

3. 将feature map变为原来的大小：
    1.上采样：一般使用插值方法。
    2.去池化(unpooling)。
    3.反卷积。

4. FCN网络可以适应任意尺寸的输入。

5. 缺点：
    1. 分割不够精细。
    2. 没有考虑上下文信息:
    ![](.\images\2021-01-28-19-03-11.png)

## **四.U-Net:**

1. U型结构：
    ![](.\images\2021-01-28-18-51-43.png)

## **五.PSPNet(Pyramid Scene Parsing Network):**

1. 增大感受野，获取上下文信息。
    感受野：卷积神经网络每一层输出的特征图（feature map）上的像素点在原始图像上映射的区域大小。
    ![](.\images\2021-01-28-19-18-59.png)
    ![](.\images\2021-01-28-19-15-57.png)
    ![](.\images\2021-01-29-14-10-32.png)
    ![](.\images\2021-01-29-14-22-16.png)
    https://fomoro.com/research/article/receptive-field-calculator#3,1,1,VALID;2,2,1,VALID;3,1,1,VALID;2,2,1,VALID;3,1,1,VALID;3,1,1,VALID;2,2,1,VALID

2. 结构：
    使用1×1Conv降维
    ![](.\images\2021-01-28-19-22-42.png)

3. Pyramid Pooling模块:
    ![](.\images\2021-01-28-19-35-43.png)

## **六.DeepLab:**

1. 网络结构：
    ![](.\images\2021-01-29-13-02-35.png)

2. 为了增大感受野，传统做法进行了过多的pooling操作，丢失了部分信息，deeplab采用了空洞卷积。
    ![](.\images\2021-01-31-19-02-28.png)

3. v1
    主要是在FCN 的基础上对VGG网络进行调参fine tuning，并在最后加上一个全连接的CRF，保证对FCN 得到的结果在局部细节(边界)上进行优化。
    ![](.\images\2021-01-29-14-46-48.png)

4. v2
    空洞空间卷积池化金字塔(atrous spatial pyramid pooling (ASPP))
    ![](.\images\2021-01-31-18-56-35.png)
    ![](.\images\2021-01-29-14-57-08.png)

5. v3
    ![](.\images\2021-01-29-14-57-23.png)

## **七.U2-Net:**

1. ![](.\images\2021-02-02-21-04-49.png)

2. 目标：设计一个新的网络，使其能够从头开始训练，并比那些基于现有的预训练骨干的网络获得类似或更好的性能

3. ![](.\images\2021-02-06-21-05-44.png)
    precision:被预测为某类的样本中正确的所占的比例
    recall:某一类样本中被正确预测出的比例
    F—measure：2*p*r/(p+r)

4. Lab colors sapce：
    Lab是由一个亮度通道（channel）和两个颜色通道组成的。在Lab颜色空间中，每个颜色用L、a、b三个数字表示，各个分量的含义是这样的：
    - L*代表亮度
    - a*代表从绿色到红色的分量
    - b*代表从蓝色到黄色的分量
    ![](.\images\2021-02-07-12-35-11.png)

## **八.loss计算:**

1. Crossentropyloss:
    二分类：
    ![](.\images\2021-01-31-18-43-08.png)
    多分类：
    ![](.\images\2021-01-31-19-18-44.png)
    ![](images\2021-01-31-19-19-06.png)

2. IOU loss:
    ![](.\images\2021-01-31-18-46-31.png)